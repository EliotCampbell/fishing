<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Удерживание шарика</title>
    <style>
        canvas {
            border: 1px solid #19FEC7;
            background-color: #00000080;
            display: block;
            border-radius: 16px;
        }
    </style>
</head>
<body>
<canvas id="gameCanvas" width="86" height="453"></canvas>

<p>Время в поле: <span id="timeCount">0</span> сек</p>

<script>
    const canvas = document.getElementById('gameCanvas')
    const ctx = canvas.getContext('2d')
    const timeCountSpan = document.getElementById('timeCount')

    const svgCursor = `<svg width="64" height="128" viewBox="0 0 64 128" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect width="64" height="128" rx="10" fill="#19FEC7"/>
                       </svg>`
    const svgFish = `<svg width="30" height="48" viewBox="0 0 30 48" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M0.0726252 31.557C0.17778 31.9209 0.273426 32.0986 0.467025 32.2895C0.830476 32.6478 1.22235 32.6706 2.42456 32.4036C3.66547 32.1281 6.21578 31.7305 6.74227 31.7305C6.76992 31.7305 6.99502 32.0847 7.2426 32.5176C8.03458 33.9028 8.86949 35.0893 10.1081 36.5899C10.7436 37.3598 10.8965 37.6083 11.0171 38.0678C11.134 38.5131 11.0978 39.1546 10.9314 39.5839C10.8526 39.7873 10.5509 40.2318 10.051 40.8809C8.78297 42.5273 8.07713 43.6111 7.46033 44.8589C6.43736 46.9282 6.57599 48 7.86665 48C8.10884 48 8.63907 47.9149 9.35289 47.7616C12.0703 47.1779 13.9333 46.9674 16.3717 46.9686C18.7477 46.9699 21.0787 47.2449 23.5584 47.8165C24.4187 48.0148 24.8004 47.9808 25.2867 47.6626C25.6394 47.4319 25.7794 47.173 25.7802 46.7506C25.7813 46.1687 25.608 45.6323 25.0967 44.6345C24.5495 43.5667 23.8641 42.5368 22.636 40.9371C22.2267 40.4039 21.8458 39.8732 21.7898 39.7577C21.3118 38.7738 21.5134 37.7728 22.3897 36.7778C22.5848 36.5563 22.7452 36.3476 22.7463 36.3141C22.7473 36.2805 22.6841 36.0631 22.6059 35.8308C22.4012 35.2229 21.7881 34.0225 21.2415 33.1594C20.9817 32.7492 20.7692 32.4049 20.7692 32.3943C20.7692 32.3837 21.4804 32.9628 22.3496 33.6812C24.6176 35.5558 24.959 35.7992 25.6405 36.0283C26.5139 36.3218 27.4528 36.1213 28.213 35.479C28.8269 34.9602 29.518 33.8179 29.8149 32.8312C30.01 32.183 30.059 31.2208 29.9228 30.7103C29.7046 29.8916 29.3616 29.5232 28.2306 28.8927C27.7882 28.6461 27.3885 28.4166 27.3421 28.3826C27.2676 28.328 27.2769 28.2621 27.4234 27.8108C28.4666 24.5949 28.7721 21.0365 28.294 17.6702C27.7155 13.5968 26.0498 9.73328 23.3603 6.22647C21.8982 4.31998 19.9126 2.34391 17.8328 0.72533C17.0554 0.120349 16.8885 0.0388405 16.3639 0.00823522C15.9972 -0.0131919 15.9044 0.00136115 15.6338 0.122337C14.7423 0.521018 11.7372 3.21682 10.2656 4.93806C7.07824 8.6662 5.12263 12.7282 4.38721 17.148C4.24967 17.9748 4.11632 19.2334 4.11489 19.7189C4.11379 20.0813 4.11126 20.0874 3.76216 20.5623C2.34326 22.4925 0.767976 26.1293 0.20521 28.774C-0.000481874 29.7405 -0.064411 31.0826 0.0726252 31.557ZM11.8155 18.5201C13.0098 18.7548 13.657 18.8111 15.1899 18.814C16.7052 18.8169 17.1189 18.7835 18.2132 18.5697C19.8272 18.2544 21.4733 17.6242 22.9136 16.7702C23.6066 16.3593 23.7375 16.2968 23.7375 16.3765C23.7375 16.4057 23.6288 16.6405 23.4959 16.8984C22.4291 18.9681 20.8559 20.2086 18.7354 20.6522C18.0387 20.7979 16.5447 20.7836 15.7808 20.624C14.5635 20.3696 13.3175 19.8661 12.3591 19.2413C11.9293 18.9612 11.2618 18.4571 11.2837 18.4292C11.2888 18.4227 11.5282 18.4636 11.8155 18.5201ZM12.3388 9.01758C13.2368 7.17171 15.8857 7.15609 16.765 8.99148C17.4575 10.4371 16.5516 12.0885 14.9159 12.3622C14.2816 12.4684 13.4914 12.2476 12.9591 11.8154C12.6972 11.6028 12.3862 11.1537 12.2487 10.7895C12.1576 10.5484 12.1401 10.3908 12.1531 9.93039C12.1673 9.42936 12.1879 9.32772 12.3388 9.01758Z" fill="#FFFFFF"/>
                     </svg>`
    const LMB = `<svg width="53" height="20" viewBox="0 0 53 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3.87012 8.73995L3.92008 13.2042C4.6818 11.5808 5.89932 10.3633 7.52268 10.3633H8.7402V8.73995V3.86987C7.98614 3.86987 7.60911 3.86987 7.29364 3.91984C5.55709 4.19488 4.19513 5.55684 3.92008 7.2934C3.87012 7.60887 3.87012 7.9859 3.87012 8.73995Z" fill="#19FEC7"/>
                    <path d="M3.92008 13.2042L3.31136 13.211L4.47119 13.4628L3.92008 13.2042ZM3.87012 8.73995H3.26132L3.2614 8.74677L3.87012 8.73995ZM3.92008 7.2934L4.52135 7.38863L4.52135 7.38863L3.92008 7.2934ZM8.7402 3.86987H9.34896V3.26111H8.7402V3.86987ZM7.29364 3.91984L7.19841 3.31857H7.19841L7.29364 3.91984ZM8.7402 10.3633V10.9721H9.34896V10.3633H8.7402ZM4.5288 13.1974L4.47884 8.73314L3.2614 8.74677L3.31136 13.211L4.5288 13.1974ZM4.47888 8.73995C4.47888 7.96263 4.48077 7.64485 4.52135 7.38863L3.31882 7.19817C3.25947 7.57289 3.26136 8.00916 3.26136 8.73995H4.47888ZM8.7402 3.26111C8.00941 3.26111 7.57313 3.25922 7.19841 3.31857L7.38888 4.5211C7.6451 4.48052 7.96288 4.47863 8.7402 4.47863V3.26111ZM4.52135 7.38863C4.75514 5.91256 5.9128 4.75489 7.38888 4.5211L7.19841 3.31857C5.20137 3.63487 3.63512 5.20113 3.31882 7.19817L4.52135 7.38863ZM9.34896 8.73995V3.86987H8.13144V8.73995H9.34896ZM7.52268 10.9721H8.7402V9.75455H7.52268V10.9721ZM9.34896 10.3633V8.73995H8.13144V10.3633H9.34896ZM7.52268 9.75455C5.54852 9.75455 4.17073 11.2369 3.36898 12.9456L4.47119 13.4628C5.19286 11.9248 6.25012 10.9721 7.52268 10.9721V9.75455Z" fill="#19FEC7"/>
                    <path d="M3.87012 8.73995H3.26136H3.87012ZM3.92008 7.2934L3.31882 7.19817L3.92008 7.2934ZM7.29364 3.91984L7.19841 3.31857L7.29364 3.91984ZM7.29364 18.4301L7.19841 19.0314L7.29364 18.4301ZM3.87012 13.61H4.47888H3.87012ZM3.92008 15.0566L3.31882 15.1518L3.92008 15.0566ZM13.6103 13.61H14.219H13.6103ZM13.5603 15.0566L14.1616 15.1518L13.5603 15.0566ZM10.1867 18.4301L10.282 19.0314L10.1867 18.4301ZM13.6103 8.73995H13.0015H13.6103ZM13.5603 7.2934L14.1616 7.19817L13.5603 7.2934ZM10.1867 3.91984L10.282 3.31857L10.1867 3.91984ZM3.87012 14.4217H3.26136H3.87012ZM7.92852 10.3633V9.75455V10.3633ZM7.92852 18.4801L7.92852 17.8714H7.92852V18.4801ZM13.6103 14.4217H14.219H13.6103ZM9.55188 18.4801L9.55188 19.0889H9.55188V18.4801ZM9.55188 10.3633V9.75455V10.3633ZM8.13144 10.3633C8.13144 10.6995 8.40399 10.9721 8.7402 10.9721C9.07641 10.9721 9.34896 10.6995 9.34896 10.3633H8.13144ZM13.0015 8.73995V13.61H14.219V8.73995H13.0015ZM4.47888 13.61L4.47888 8.73995H3.26136L3.26136 13.61H4.47888ZM4.47888 8.73995C4.47888 7.96263 4.48077 7.64485 4.52135 7.38863L3.31882 7.19817C3.25947 7.57289 3.26136 8.00916 3.26136 8.73995H4.47888ZM8.7402 3.26111C8.00941 3.26111 7.57313 3.25922 7.19841 3.31857L7.38888 4.5211C7.6451 4.48052 7.96288 4.47863 8.7402 4.47863V3.26111ZM4.52135 7.38863C4.75514 5.91256 5.9128 4.75489 7.38888 4.5211L7.19841 3.31857C5.20137 3.63487 3.63512 5.20113 3.31882 7.19817L4.52135 7.38863ZM8.7402 17.8714C7.96288 17.8714 7.6451 17.8695 7.38887 17.8289L7.19841 19.0314C7.57313 19.0908 8.00941 19.0889 8.7402 19.0889V17.8714ZM3.26136 13.61C3.26136 14.3408 3.25947 14.7771 3.31882 15.1518L4.52135 14.9614C4.48077 14.7051 4.47888 14.3874 4.47888 13.61H3.26136ZM7.38887 17.8289C5.9128 17.5951 4.75514 16.4374 4.52135 14.9614L3.31882 15.1518C3.63512 17.1489 5.20137 18.7151 7.19841 19.0314L7.38887 17.8289ZM13.0015 13.61C13.0015 14.3874 12.9996 14.7051 12.959 14.9614L14.1616 15.1518C14.2209 14.7771 14.219 14.3408 14.219 13.61H13.0015ZM8.7402 19.0889C9.47099 19.0889 9.90726 19.0908 10.282 19.0314L10.0915 17.8289C9.8353 17.8695 9.51751 17.8714 8.7402 17.8714V19.0889ZM12.959 14.9614C12.7253 16.4374 11.5676 17.5951 10.0915 17.8289L10.282 19.0314C12.279 18.7151 13.8453 17.1489 14.1616 15.1518L12.959 14.9614ZM14.219 8.73995C14.219 8.00916 14.2209 7.57289 14.1616 7.19817L12.959 7.38863C12.9996 7.64485 13.0015 7.96263 13.0015 8.73995H14.219ZM8.7402 4.47863C9.51751 4.47863 9.8353 4.48052 10.0915 4.5211L10.282 3.31857C9.90726 3.25922 9.47099 3.26111 8.7402 3.26111V4.47863ZM14.1616 7.19817C13.8453 5.20113 12.279 3.63487 10.282 3.31857L10.0915 4.5211C11.5676 4.75489 12.7253 5.91256 12.959 7.38863L14.1616 7.19817ZM9.55188 17.8714L7.92852 17.8714L7.92852 19.0889L9.55188 19.0889L9.55188 17.8714ZM7.92852 10.9721H9.55188V9.75455H7.92852V10.9721ZM4.47888 14.4217C4.47888 12.5165 6.02333 10.9721 7.92852 10.9721V9.75455C5.35092 9.75455 3.26136 11.8441 3.26136 14.4217H4.47888ZM7.92852 17.8714C6.02333 17.8714 4.47888 16.3269 4.47888 14.4217H3.26136C3.26136 16.9993 5.35092 19.0889 7.92852 19.0889L7.92852 17.8714ZM13.0015 14.4217C13.0015 16.3269 11.4571 17.8714 9.55188 17.8714V19.0889C12.1295 19.0889 14.219 16.9993 14.219 14.4217H13.0015ZM14.219 14.4217C14.219 11.8441 12.1295 9.75455 9.55188 9.75455V10.9721C11.4571 10.9721 13.0015 12.5165 13.0015 14.4217H14.219ZM9.34896 10.3633V3.86987H8.13144V10.3633H9.34896Z" fill="white"/>
                    <path d="M5.78311 1.00001L5.78311 1.71748L5.78311 1.00001ZM6.73974 1.71748C7.13598 1.71748 7.4572 1.39626 7.4572 1.00001C7.4572 0.603763 7.13598 0.282542 6.73974 0.282542L6.73974 1.71748ZM0.282533 6.73975C0.282533 7.13599 0.603754 7.45721 1 7.45721C1.39625 7.45721 1.71747 7.13599 1.71747 6.73975L0.282533 6.73975ZM1 5.78312L0.282533 5.78312L1 5.78312ZM5.78311 1.71748L6.73974 1.71748L6.73974 0.282542L5.78311 0.282542L5.78311 1.71748ZM1.71747 6.73975L1.71747 5.78312L0.282533 5.78312L0.282533 6.73975L1.71747 6.73975ZM5.78311 0.282542C2.74523 0.282542 0.282533 2.74524 0.282533 5.78312L1.71747 5.78312C1.71747 3.53773 3.53772 1.71748 5.78311 1.71748L5.78311 0.282542Z" fill="white"/>
                    <path d="M33.0598 7.54144V16H32.1777V8.31479H28.0934L27.9967 11.1424C27.9565 12.3105 27.8598 13.253 27.7067 13.9699C27.5617 14.6789 27.3362 15.2105 27.0301 15.565C26.7239 15.9114 26.3171 16.0846 25.8096 16.0846C25.5921 16.0846 25.3665 16.0564 25.1329 16L25.2054 15.2025C25.3424 15.2347 25.4753 15.2508 25.6042 15.2508C25.9586 15.2508 26.2446 15.1098 26.4621 14.8279C26.6877 14.5459 26.8569 14.1109 26.9696 13.5229C27.0824 12.9267 27.1589 12.1413 27.1992 11.1665L27.3201 7.54144H33.0598ZM38.7168 12.1211H36.7835V16H35.9134V7.54144H36.7835V11.3357H38.7168L41.5807 7.54144H42.5474L39.4056 11.6499L42.7286 16H41.7015L38.7168 12.1211ZM52.8878 7.54144V16H52.0298V9.23315L48.7068 14.9246H48.2839L44.9609 9.2694V16H44.1029V7.54144H44.84L48.5135 13.8129L52.1507 7.54144H52.8878Z" fill="white"/>
                 </svg>`
    const line = `<svg width="71" height="2" viewBox="0 0 71 2" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M0.5 1H70.5" stroke="white"/>
                     </svg>`

    let lastFrameTime = 0
    let fishRadius = 24
    let fishY = canvas.height / 2
    let fieldY = canvas.height - 128; // Начальное положение поля
    let fishSpeed = 2 // Скорость движения шарика
    let fieldSpeed = 3 // Скорость движения поля
    let isInField = false

    let timeCount = 0

    function moveObjects(cursor, fish) {
        fishY += fishSpeed // Перемещаем рыбу на расстояние равное скорости

        // Проверка выхода рыбы за верхнее ограничение, учитывая высоту курсора, рыбы и отступ сверху
        // Проверка выхода рыбы за нижнее ограничение, учитывая высоту рыбы, курсора и отступ снизу
        if (fishY <= cursor.height/2 - fish.height/2 + 46  || fishY >= canvas.height - fish.height/2 - cursor.height/2 - 46 - 20) {
            fishSpeed *= -1
        } // Инвертируем скорость, если рыба уперлась в стену

        fieldY += fieldSpeed // Смещаем поле ниже

        if (fieldY <= 46) { // Проверка выхода поля за верхнюю границу, учитывая отступ сверху
            fieldY = 46
        } else if (fieldY >= canvas.height - 128 - 46 - 20) { // Учитываем высоту поля, высоту подсказки, размер отступа снизу, проверяем выход за нижнюю границу
            fieldY = canvas.height - 128 - 46 - 20
        }

        if (fishY > fieldY && fishY < fieldY + 128) { // Проверка, находится ли рыба в курсоре
            isInField = true
        } else {
            isInField = false
        }
    }

    function updateTimer() {
        let currentTime = performance.now()
        let deltaTime = currentTime - lastFrameTime

        if (isInField) {
            timeCount += deltaTime
        } else {
            timeCount -= deltaTime // Уменьшаем время, если шарик вне поля
            if (timeCount < 0) {
                timeCount = 0
            }
        }

        lastFrameTime = currentTime

        timeCountSpan.textContent = (timeCount / 1000).toFixed() // Время в секундах
    }

    setInterval(updateTimer, 1) // Обновляем таймер каждую миллисекунду

    function handleMouseDown() {
        fieldSpeed = -3 // Уменьшаем скорость для опускания поля
    }

    function handleMouseUp() {
        fieldSpeed = 3 // Увеличиваем скорость для подъема поля
    }

    canvas.addEventListener('mousedown', handleMouseDown)
    canvas.addEventListener('mouseup', handleMouseUp)

    function randomizeFishMovement() {
        setTimeout(() => {
            fishSpeed = Math.random() > 0.5 ? -2 : 2; // Случайное движение вверх или вниз
            randomizeFishMovement() // Запуск следующего случайного движения
        }, Math.random() * 500 + 1500); // Случайный интервал от 0.5 до 1.5 секунд
    }

    randomizeFishMovement() // Запуск первого случайного движения

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height)

        // Draw field
        const cursor = new Image()
        cursor.src = 'data:image/svg+xml,' + encodeURIComponent(svgCursor)
        ctx.drawImage(cursor, canvas.width/2 - cursor.width/2, fieldY)

        // Draw fish
        const fish = new Image()
        fish.src = 'data:image/svg+xml,' + encodeURIComponent(svgFish)
        ctx.drawImage(fish, canvas.width/2 - fish.width/2, fishY)

        // Draw mouse icon
        const mouseButton = new Image()
        mouseButton.src = 'data:image/svg+xml,' + encodeURIComponent(LMB)
        ctx.drawImage(mouseButton, canvas.width/2 - mouseButton.width/2, canvas.height - 37)

        const splitter = new Image()
        splitter.src = 'data:image/svg+xml,' + encodeURIComponent(line)
        ctx.drawImage(splitter, canvas.width/2 - splitter.width/2, canvas.height - 47)

        moveObjects(cursor, fish);
        requestAnimationFrame(draw)
    }

    draw();
</script>
</body>
</html>
